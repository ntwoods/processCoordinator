<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NT Woods - PC Dashboard</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <!-- Analytics (same as earlier, optional) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-CF428LGWLQ"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){ dataLayer.push(arguments); }
    gtag('js', new Date()); gtag('config', 'G-CF428LGWLQ');
  </script>

  <style>
    :root{
      /* White & Blue theme */
      --bg: #f7faff;
      --bg-soft: #eef5ff;
      --panel: #ffffff;
      --text: #0f172a;      /* slate-900 */
      --muted: #334155;     /* slate-700 */
      --blue-50:#eff6ff;
      --blue-100:#dbeafe;
      --blue-200:#bfdbfe;
      --blue-300:#93c5fd;
      --blue-400:#60a5fa;
      --blue-500:#3b82f6;
      --blue-600:#2563eb;
      --blue-700:#1d4ed8;

      --ok:#10b981;         /* green-500 */
      --warn:#ef4444;       /* red-500 */
      --ring:#60a5fa;

      --radius:16px;
      --shadow:0 8px 24px rgba(2, 6, 23, .08);
    }
    *{ box-sizing: border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height:1.35;
    }

    /* Header */
    .header{
      position: sticky; top:0; z-index:20;
      background: linear-gradient(180deg, var(--blue-600), var(--blue-700));
      color:#fff;
      box-shadow: var(--shadow);
    }
    .header-inner{
      max-width: 1280px; margin: 0 auto; padding: 12px 20px;
      display:flex; align-items:center; justify-content:space-between;
    }
    .brand{
      display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.3px;
    }
    .brand .logo{ font-size:22px; }
    .theme-toggle{
      background:#fff; color:var(--blue-700);
      border:none; padding:10px 14px; border-radius: 999px;
      font-weight:600; cursor:pointer;
      box-shadow: 0 4px 14px rgba(255,255,255,.25);
    }
    .theme-toggle:focus-visible{
      outline:3px solid #fff; outline-offset:2px;
    }

    /* Layout */
    .shell{
      max-width:1280px; margin: 18px auto; padding: 0 16px;
      display:grid; grid-template-columns: 280px 1fr; gap:18px;
    }
    @media (max-width: 1024px){
      .shell{ grid-template-columns:1fr; }
    }

    /* Sidebar */
    aside.sidebar{
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding:14px;
      position: sticky; top:84px; align-self:start;
    }
    .sidebar nav[aria-label="Primary"] ul{
      list-style:none; margin:0; padding:0;
      display:flex; flex-direction:column; gap:10px;
    }
    .side-link{
      display:inline-flex; align-items:center; gap:10px;
      padding:10px 12px; width:100%;
      text-decoration:none;
      border-radius:12px;
      background: var(--blue-50);
      color: var(--muted);
      border:1px solid var(--blue-100);
      transition: transform .15s ease, box-shadow .15s ease, background-color .15s ease, border-color .15s ease;
    }
    .side-link:hover{ transform: translateY(-1px); background: var(--blue-100); }
    .side-link:focus-visible{
      outline:3px solid var(--ring); outline-offset:2px;
    }
    .side-emoji{ font-size:18px; }

    /* Main content */
    main.content{ display:flex; flex-direction:column; gap:22px; }

    section.section{
      background: var(--panel);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 18px;
    }
    .section-title{
      margin:0 0 12px; font-weight:800; letter-spacing:.2px;
      display:flex; align-items:center; gap:8px;
      color: var(--blue-700);
    }

    /* Grids */
    .grid-tiles{
      display:grid; gap:14px;
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
    @media (max-width: 900px){
      .grid-tiles{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    @media (max-width: 600px){
      .grid-tiles{ grid-template-columns: 1fr; }
    }

    .grid-auto{
      display:grid; gap:14px;
      grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
    }

    /* Cards */
    .card{
      background: linear-gradient(180deg, #ffffff, var(--bg-soft));
      border:1px solid var(--blue-100);
      border-radius: 14px;
      padding: 16px;
      cursor: pointer;
      transition: transform .15s ease, box-shadow .15s ease, background-color .15s ease, border-color .15s ease;
    }
    .card:hover{ transform: translateY(-3px); box-shadow: var(--shadow); }
    .card:focus-visible{ outline:3px solid var(--ring); outline-offset:3px; transform: translateY(-3px); }
    .card .icon{ font-size:22px; }
    .card .title{ margin:8px 0 4px; font-weight:800; }
    .card .count{ font-weight:800; color: var(--muted); }

    /* Status tint helpers */
    .ok    { border-color:#a7f3d0; background: linear-gradient(180deg, #ffffff, #e8fff4); }
    .warn  { border-color:#fecaca; background: linear-gradient(180deg, #ffffff, #fff1f2); }

    /* Inventory/Claims â€œpulseâ€ (reduced-motion safe) */
    .pulse{ animation: pulse 1.4s ease-out infinite; }
    @keyframes pulse{
      0%{ box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.35); }
      70%{ box-shadow: 0 0 0 10px rgba(239, 68, 68, 0); }
      100%{ box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
    }
    @media (prefers-reduced-motion: reduce){
      .pulse{ animation: none !important; }
      .card, .side-link{ transition: none !important; }
    }

    /* Minor utilities */
    .muted{ color: var(--muted); }
    .spacer{ height:4px; }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="header">
    <div class="header-inner">
      <div class="brand">
        <span class="logo">ğŸŒ²</span>
        <span>NT Woods â€” PC Dashboard</span>
      </div>
      <button class="theme-toggle" aria-label="Toggle dark mode" aria-pressed="false" onclick="toggleDarkMode(this)">
        ğŸŒ“ Toggle Theme
      </button>
    </div>
  </header>

  <!-- Shell: Sidebar + Content -->
  <div class="shell">
    <!-- Sidebar (semantic single <nav>) -->
    <aside class="sidebar">
      <nav aria-label="Primary">
        <ul>
          <li><a class="side-link" href="https://ntwoods.github.io/ordertodispatch/O2DjourneyPC.html"><span class="side-emoji">ğŸ¦â€ğŸ”¥</span><span>O2D Journey</span></a></li>
          <li><a class="side-link" href="https://ntwoods.github.io/ordertodispatch/completedSalesOrders.html"><span class="side-emoji">ğŸ›’</span><span>Completed SO</span></a></li>
          <li><a class="side-link" href="https://lookerstudio.google.com/reporting/b0d4bdd0-5e55-4163-9f36-0d292dab25e6/page/page_12345"><span class="side-emoji">â˜‘ï¸</span><span>CheckList</span></a></li>
          <li><a class="side-link" href="https://ntwoods.github.io/processCoordinator/scotPC.html"><span class="side-emoji">ğŸ¥ƒ</span><span>SCOT PORTAL</span></a></li>
          <li><a class="side-link" href="https://ntwoods.github.io/PurchaseOrders/crmPurchaseReqView.html?mode=view"><span class="side-emoji">ğŸ‘¤</span><span>CRM Requests</span></a></li>
          <li><a class="side-link" href="https://ntwoods.github.io/ordertodispatch/informOwnersClaimReq.html?mode=view"><span class="side-emoji">ğŸ›„</span><span>Claim Requests</span></a></li>
          <li><a class="side-link" href="https://ntwoods.github.io/PurchaseOrders/missingSupplierCategories.html?mode=view"><span class="side-emoji">ğŸ“¦</span><span>Manage Categories</span></a></li>
          <li><a class="side-link" href="https://ntwoods.github.io/ordertodispatch/raiseTicket.html"><span class="side-emoji">ğŸ†˜</span><span>Help Slip</span></a></li>
          <li><a class="side-link" href="https://docs.google.com/spreadsheets/d/1UeohB4IPgEzGwybOJaIKpCIa38A4UvBstM8waqYv9V0/edit?gid=0#gid=0"><span class="side-emoji">ğŸ§¾</span><span>IMS NT Woods</span></a></li>
          <li><a class="side-link" href="https://docs.google.com/spreadsheets/d/13tKeARKt4U1fteW6N31nRDfY3zWX4aEqnLrv-8eKpiE/edit?gid=0#gid=0"><span class="side-emoji">ğŸ§¾</span><span>IMS NexTree</span></a></li>
          <li><a class="side-link" href="https://docs.google.com/spreadsheets/d/1Sfwb5OwFhpeHsenSyP5lhH-ykdvbj_PPFjDBe4yUibA/edit?gid=763969696#gid=763969696"><span class="side-emoji">ğŸ§¾</span><span>IMS Order Merging</span></a></li>
        </ul>
      </nav>
    </aside>

    <!-- Main -->
    <main class="content" id="main-content">

      <!-- 1) Top 3 tiles -->
      <section class="section" id="top-tiles">
        <h2 class="section-title">ğŸ“‹ Sales Orders â€” Quick Actions</h2>
        <div class="grid-tiles">
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L00.html?mode=view" id="tile-crm-assign">
            <div class="icon">ğŸ¯</div>
            <div class="title">CRM Assigning Pending</div>
            <div class="count" data-key="crmAssign">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/OwnerApprovalSOview.html" id="tile-owner-approval">
            <div class="icon">âœ…</div>
            <div class="title">Ownerâ€™s Approval</div>
            <div class="count" data-key="ownerApproval">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/DispatchTeam.html?mode=view" id="tile-dispatch-team">
            <div class="icon">ğŸš›</div>
            <div class="title">Dispatch Team</div>
            <div class="count" data-key="dispatchTeam">Open</div>
          </a>
        </div>
      </section>

      <!-- 2) O2D â€” CRM section only -->
      <section class="section" id="o2d-crm">
        <h2 class="section-title">ğŸ‘¥ O2D â€” CRM Level</h2>
        <div class="grid-auto">
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L1.html?mode=view">
            <div class="icon">1ï¸âƒ£</div><div class="title">Credit & Stock Check</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L2.html?mode=view">
            <div class="icon">2ï¸âƒ£</div><div class="title">Dealer Call & Update</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L3.html?mode=view">
            <div class="icon">3ï¸âƒ£</div><div class="title">Tentative Dispatch Date</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L4.html?mode=view">
            <div class="icon">4ï¸âƒ£</div><div class="title">Dispatch Reminder</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L5.html?mode=view">
            <div class="icon">5ï¸âƒ£</div><div class="title">Dispatch Info to Dealer</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L6.html?mode=view">
            <div class="icon">6ï¸âƒ£</div><div class="title">Delivery Confirmation</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/ordertodispatch/L7.html?mode=view">
            <div class="icon">7ï¸âƒ£</div><div class="title">Hold Order Management</div><div class="count muted">Open</div>
          </a>
        </div>
      </section>

      <!-- 3) Purchase Section -->
      <section class="section" id="purchase">
        <h2 class="section-title">ğŸ’¼ Purchase â€” Actions</h2>
        <div class="grid-auto">
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/POverifier.html?mode=view">
            <div class="icon">ğŸ”</div><div class="title">PO Verification</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/SendToSupplier.html?mode=view">
            <div class="icon">ğŸ“¤</div><div class="title">Send PO to Supplier</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/GetDispatchDate.html?mode=view">
            <div class="icon">ğŸ“…</div><div class="title">Get Dispatch Date</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/DispatchFollowUp.html?mode=view">
            <div class="icon">ğŸ“</div><div class="title">Dispatch Follow Up</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/DispatchFollowUpADayBefore.html?mode=view">
            <div class="icon">ğŸ“</div><div class="title">Dispatch Follow Up A Day Before</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/GetDispatch&LR.html?mode=view">
            <div class="icon">ğŸ“‹</div><div class="title">Get Dispatch & LR Details</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/ReceivedAtGodown.html?mode=view">
            <div class="icon">ğŸ“¦</div><div class="title">Goods Received At Godown</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/manageHoldPO.html?mode=view">
            <div class="icon">ğŸ§Š</div><div class="title">Manage Hold PO</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/AcDashboard.html?mode=view">
            <div class="icon">ğŸ“Š</div><div class="title">Accounts Portal</div><div class="count muted">Open</div>
          </a>
          <a class="card" href="https://ntwoods.github.io/PurchaseOrders/PO_WATCH">
            <div class="icon">ğŸ¯</div><div class="title">360Â° PO Watch</div><div class="count muted">Monitor All</div>
          </a>
        </div>
      </section>

      <!-- 4) Claim Section -->
      <section class="section" id="claims">
        <h2 class="section-title">ğŸ›„ Claim Management</h2>
        <div class="grid-auto">
          <a class="card" id="tile-claim-crm" href="https://ntwoods.github.io/ordertodispatch/informOwnersClaimReq.html?mode=view">
            <div class="icon">ğŸ‘¥</div><div class="title">Claims at CRM End</div><div class="count" id="count-claim-crm">Loadingâ€¦</div>
          </a>
          <a class="card" id="tile-claim-acc" href="https://ntwoods.github.io/ordertodispatch/claimRequestAtAccounts.html?mode=view">
            <div class="icon">ğŸ¦</div><div class="title">Claims at Accounts End</div><div class="count" id="count-claim-acc">Loadingâ€¦</div>
          </a>
        </div>
      </section>

      <!-- 5) Inventory Section -->
      <section class="section" id="inventory">
        <h2 class="section-title">ğŸ§¾ Inventory Audit</h2>
        <div class="grid-auto">
          <a class="card" id="card-start" href="https://ntwoods.github.io/audit/startAudit.html?mode=view">
            <div class="icon">â–¶ï¸</div><div class="title">START AUDIT</div><div class="count" id="count-start">Loadingâ€¦</div>
          </a>
          <a class="card" id="card-verify-audit" href="https://ntwoods.github.io/audit/verifyAudit.html?mode=view">
            <div class="icon">âœ…</div><div class="title">VERIFY AUDIT</div><div class="count" id="count-verify-audit">Loadingâ€¦</div>
          </a>
          <a class="card" id="card-journal" href="https://ntwoods.github.io/audit/journalEntry.html?mode=view">
            <div class="icon">ğŸ§¾</div><div class="title">JOURNAL ENTRY</div><div class="count" id="count-journal">Loadingâ€¦</div>
          </a>
          <a class="card" id="card-verify" href="https://ntwoods.github.io/audit/verifyJournalEntry?mode=view">
            <div class="icon">ğŸ”</div><div class="title">VERIFY JOURNAL ENTRIES</div><div class="count" id="count-verify">Loadingâ€¦</div>
          </a>
          <a class="card" id="card-account" href="https://ntwoods.github.io/audit/tallyTask?mode=view">
            <div class="icon">ğŸ“š</div><div class="title">ACCOUNT WORKING</div><div class="count" id="count-account">Loadingâ€¦</div>
          </a>
        </div>
      </section>

    </main>
  </div>

  <script>
    // Dark mode toggle (adds/removes .dark on <html>)
    function toggleDarkMode(btn){
      const isDark = document.documentElement.classList.toggle('dark');
      btn && btn.setAttribute('aria-pressed', String(isDark));
    }

    // Optional: style tweaks for dark mode (minimal; keeps â€œWhite & Blueâ€ spirit)
    (function injectDark(){
      const css = `
        :root{ color-scheme: light dark; }
        html.dark body{ background:#0b1220; color:#e5ecff; }
        html.dark .header{ background: linear-gradient(180deg, #0b3aa8, #0b2f88); }
        html.dark .sidebar, html.dark section.section{ background: #0f1a33; border:1px solid #1f3a7a; }
        html.dark .card{ background: linear-gradient(180deg, #112043, #0f1a33); border-color:#1f3a7a; }
        html.dark .side-link{ background:#0f2349; border-color:#1f3a7a; color:#d7e3ff; }
        html.dark .side-link:hover{ background:#143061; }
        html.dark .section-title{ color:#9ec0ff; }
      `;
      const s=document.createElement('style'); s.textContent=css; document.head.appendChild(s);
    })();

    // ====== Data loading for Inventory & Claims (endpoints from your existing file) ======
    const endpoints = {
      start:  "https://script.google.com/macros/s/AKfycbze820nXuy0s0RZNajlPzFq4AeyEaOhjp3IS_tqfi2RB7XKbzYvOi2nwXFUEUqtXh56/exec?action=pending",
      verifyAudit: "https://script.google.com/macros/s/AKfycbze820nXuy0s0RZNajlPzFq4AeyEaOhjp3IS_tqfi2RB7XKbzYvOi2nwXFUEUqtXh56/exec?action=error",
      journal: "https://script.google.com/macros/s/AKfycbze820nXuy0s0RZNajlPzFq4AeyEaOhjp3IS_tqfi2RB7XKbzYvOi2nwXFUEUqtXh56/exec?action=verifyerror",
      verify: "https://script.google.com/macros/s/AKfycbze820nXuy0s0RZNajlPzFq4AeyEaOhjp3IS_tqfi2RB7XKbzYvOi2nwXFUEUqtXh56/exec?action=journalentry",
      account: "https://script.google.com/macros/s/AKfycbze820nXuy0s0RZNajlPzFq4AeyEaOhjp3IS_tqfi2RB7XKbzYvOi2nwXFUEUqtXh56/exec?action=verifiedjournalentry",
      claimCrm: 'https://script.google.com/macros/s/AKfycbw8K5xr1V52_zKMfy9gJyWZE0kuxsu0Gjoo2bdNfIXz9-zDDxFCHp2i4mdrLDZxs-BFbA/exec',
      claimAcc: 'https://script.google.com/macros/s/AKfycbz0AMQP0qbmcpDl85pjfhF-0B1PW1GxQz_qRJj0ShDS0Pf4-CgVjslrY8CFmfX_hbzdeg/exec',
    };

    async function fetchData(url){
      const u = new URL(url); u.searchParams.set("_", Date.now());
      try{
        const res = await fetch(u, { cache: "no-store" });
        if(!res.ok) return [];
        const json = await res.json();
        if(Array.isArray(json)) return json;
        if(json && Array.isArray(json.data)) return json.data;
        if(json && json.success === true && Array.isArray(json.records)) return json.records;
        return [];
      }catch{ return []; }
    }

    function paintCount(cardEl, count){
      if(!cardEl) return;
      cardEl.classList.remove('ok','warn','pulse');
      const c = cardEl.querySelector('.count');
      if(!c) return;
      if(count > 0){
        cardEl.classList.add('warn','pulse');
        c.textContent = count + " pending";
      }else{
        cardEl.classList.add('ok');
        c.textContent = "All Clear";
      }
    }

    async function loadInventoryAndClaims(){
      try{
        const [startArr, verAudArr, journalArr, verifyArr, accArr, crmArr, accClaimArr] = await Promise.all([
          fetchData(endpoints.start),
          fetchData(endpoints.verifyAudit),
          fetchData(endpoints.journal),
          fetchData(endpoints.verify),
          fetchData(endpoints.account),
          fetchData(endpoints.claimCrm),
          fetchData(endpoints.claimAcc),
        ]);
        paintCount(document.getElementById("card-start"), startArr.length);
        paintCount(document.getElementById("card-verify-audit"), verAudArr.length);
        paintCount(document.getElementById("card-journal"), journalArr.length);
        paintCount(document.getElementById("card-verify"), verifyArr.length);
        paintCount(document.getElementById("card-account"), accArr.length);
        paintCount(document.getElementById("tile-claim-crm"), crmArr.length);
        paintCount(document.getElementById("tile-claim-acc"), accClaimArr.length);
      }catch(e){
        ["card-start","card-verify-audit","card-journal","card-verify","card-account","tile-claim-crm","tile-claim-acc"].forEach(id=>{
          const el = document.getElementById(id);
          if(!el) return;
          el.classList.remove('ok','warn','pulse');
          const c = el.querySelector('.count'); if(c) c.textContent="Error";
        });
      }
    }

    // Init
    loadInventoryAndClaims();
  </script>
</body>
</html>
